# Архитектура AlphaGAN

### Какую проблему решает AlphaGAN
Ранее для задачи natural image matting использовались обычные CNN,
которые решали её как задачу различения цветов между объектом и фоном.
Однако, когда распределения цветов перекрывались (например, волосы на фоне дерева),
такие модели допускали ошибки.
Кроме того, из-за отсутствия большого обучающего набора данных обучение CNN было ограниченным.

После появления датасета Xu et al. (2017) стало возможно обучать более сложные сети.
На этой основе авторы статьи AlphaGAN предложили использовать Generative Adversarial Network (GAN):

Генератор предсказывает альфа-маску — значения прозрачности в диапазоне [0, 1];

Дискриминатор оценивает, насколько “реалистично” выглядит результат —
может ли отличить изображение, составленное с предсказанной альфой,
от изображения, составленного с настоящей альфой.

Таким образом, генератор учится предсказывать альфы, которые не только точны численно,
но и выглядят естественно при наложении на фон.

---
### Главная идея GAN в этой задаче:

Не просто минимизировать ошибку пиксель к пикселю,
а научить сеть создавать альфа-маски, которые визуально реалистичны
— как будто они были настоящие.

### На каком датасете обучалась?

В статье авторы пишут что модель обучалась на датасете `Adobe Image Matting Dataset` 

![](images/adbimgmat.png)

Всего в датасете 431 уникальный объект без фона, так как для задачи машинного обучения этого мало, авторы дополнительно использовали датасет `MSCOCO(Microsoft Common Objects in Context)`

![](images/cocopreview.png)

Они делали композиты путем объединения изображения переднего плана, с случайным изображением из `MSCOCO`. Так же были использованы следующие аугментации для повышения обобщающей способности: `horizontal flip, random rotate, random crop на основе серой часты trimap(то место где нужно вычислить прозрачность)`.

**Trimap** - это вспомогательная маска, которая делит изображение на три области:
* белая — точно объект,
* чёрная — точно фон,
* серая — неизвестная зона, где модель должна предсказать значения альфа.